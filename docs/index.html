<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Static Analysis of R-Code Dependencies • checkglobals</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Static Analysis of R-Code Dependencies">
<meta name="description" content="A minimal R-package to approximately detect global and imported functions or variables from R-source code or R-packages by static code analysis.">
<meta property="og:description" content="A minimal R-package to approximately detect global and imported functions or variables from R-source code or R-packages by static code analysis.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">checkglobals</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JorisChau/checkglobals/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="checkglobals">{checkglobals}<a class="anchor" aria-label="anchor" href="#checkglobals"></a>
</h1></div>
<!-- badges: start -->

<p>The minimal {checkglobals}-package allows to approximately detect global and imported functions or variables from R-source code or R-packages by statically inspecting the internal syntax trees of the code, (i.e. <a href="https://en.wikipedia.org/wiki/Static_program_analysis" class="external-link">static code analysis</a>). The aim of this package is to serve as a fast and light-weight alternative to <code><a href="https://rdrr.io/pkg/codetools/man/findGlobals.html" class="external-link">codetools::findGlobals()</a></code> to check R-packages or R-scripts for missing function imports and/or variable definitions on-the-fly without the need for package installation or code execution. The code inspection procedures are implemented using R’s internal C API for efficiency, and no external R-package dependencies are strictly required, only <a href="https://CRAN.R-project.org/package=cli" class="external-link">cli</a> and <a href="https://CRAN.R-project.org/package=knitr" class="external-link">knitr</a> are suggested for interactive use and checking Rmd documents respectively.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install latest release from CRAN:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"checkglobals"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install the development version from GitHub:</span></span>
<span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"JorisChau/checkglobals"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-usage">Example usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h2>
<div class="section level3">
<h3 id="r-scripts">R-scripts<a class="anchor" aria-label="anchor" href="#r-scripts"></a>
</h3>
<p>The {checkglobals}-package contains a single wrapper function <code><a href="reference/checkglobals.html">checkglobals()</a></code> to inspect R-scripts, folders, R-code strings or R-packages. Individual R-scripts can be scanned for global variables and imported functions using the <code>file</code> argument:</p>
<p><img src="reference/figures/README/screen01.svg" width="85%" style="display: block; margin: auto;"></p>
<p><br></p>
<p>The R-script in this example contains a simple R-Shiny application available at <a href="https://raw.githubusercontent.com/rstudio/shiny-examples/main/004-mpg/app.R" class="external-link uri">https://raw.githubusercontent.com/rstudio/shiny-examples/main/004-mpg/app.R</a>.</p>
<div class="section level4">
<h4 id="printed-output">Printed output<a class="anchor" aria-label="anchor" href="#printed-output"></a>
</h4>
<p>Printing the S3-object returned by <code><a href="reference/checkglobals.html">checkglobals()</a></code> outputs: 1. the <em>name</em> and <em>location</em> of all unrecognized global variables; and 2. the <em>name</em> and <em>location</em> of all detected imported functions grouped by R-package.</p>
<p>The <em>location</em> <code>app.R#36</code> lists the R-file name (<code>app.R</code>) and line number (<code>36</code>) of the detected variable or function. If <a href="https://CRAN.R-project.org/package=cli" class="external-link">cli</a> is installed and cli-hyperlinks are supported, clicking the <em>location</em> links opens the source file pointing to the given line number. The bars and counts behind the imported package names highlight the number of function calls detected from each package. This information can be used to get a better sense of the importance of an imported package and how much effort it would take to remove it as a dependency.</p>
<p>To inspect only the detected global variables or imported functions, index the S3-object by its <code>globals</code> (<code>chk$globals</code>) or <code>imports</code> (<code>chk$imports</code>) components. For instance, we can print detailed source code references of the unrecognized global variables with:</p>
<p><img src="reference/figures/README/screen02.svg" width="85%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="remote-files">Remote files<a class="anchor" aria-label="anchor" href="#remote-files"></a>
</h4>
<p>Instead of a local file, the <code>file</code> argument in <code><a href="reference/checkglobals.html">checkglobals()</a></code> can also be a remote file location (e.g. a server or the web), in which case the remote file is first downloaded as a temporary file with <code><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file()</a></code>.</p>
<p><img src="reference/figures/README/screen03.svg" width="85%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="r-markdown-files">R Markdown files<a class="anchor" aria-label="anchor" href="#r-markdown-files"></a>
</h3>
<p>The <code>file</code> argument in <code><a href="reference/checkglobals.html">checkglobals()</a></code> also accepts R Markdown (<code>.Rmd</code> or <code>.Rmarkdown</code>) file locations. For R Markdown files, the R code chunks are first extracted into a temporary R-script with <code><a href="https://rdrr.io/pkg/knitr/man/knit.html" class="external-link">knitr::purl()</a></code>, which is then analyzed by <code><a href="reference/checkglobals.html">checkglobals()</a></code>:</p>
<p><img src="reference/figures/README/screen04.svg" width="85%" style="display: block; margin: auto;"></p>
<p><br></p>
<p><strong>Note</strong>: R-packages that are imported or loaded, but have no detected function imports are displayed with an <em>n/a</em> reference. This can happen when <code><a href="reference/checkglobals.html">checkglobals()</a></code> falsely ignores one or more imported functions from the given package or when the package is not actually needed as a dependency. In both cases this is useful information to have. In the above example, <code>tibble</code> is loaded in order to use <code>tribble()</code>, but the <code>tribble()</code> function is also exported by <code>dplyr</code>, so it shows up under the <code>dplyr</code> imports instead.</p>
</div>
<div class="section level3">
<h3 id="folders">Folders<a class="anchor" aria-label="anchor" href="#folders"></a>
</h3>
<p>Folders containing R-scripts can be scanned with the <code>dir</code> argument in <code><a href="reference/checkglobals.html">checkglobals()</a></code>, which inspects all R-scripts present in <code>dir</code>. The following example scans an R-Shiny app folder containing a <code>ui.R</code> and <code>server.R</code> file (source: <a href="https://github.com/rstudio/shiny-examples/tree/main/018-datatable-options" class="external-link uri">https://github.com/rstudio/shiny-examples/tree/main/018-datatable-options</a>),</p>
<p><img src="reference/figures/README/screen05.svg" width="85%" style="display: block; margin: auto;"></p>
<p><br></p>
<p><strong>Note</strong>: if imports are detected from an R-package not installed in the current R-session, an alert is printed as in the example above. Function calls accessing the missing R-package explicitly, using e.g. <code>::</code> or <code>:::</code>, can still be fully identified as imports by <code><a href="reference/checkglobals.html">checkglobals()</a></code>. Function calls with no reference to the missing R-package will be listed as unrecognized globals.</p>
</div>
<div class="section level3">
<h3 id="r-packages">R-packages<a class="anchor" aria-label="anchor" href="#r-packages"></a>
</h3>
<p>R-package folders can be scanned with the <code>pkg</code> argument in <code><a href="reference/checkglobals.html">checkglobals()</a></code>. Conceptually, <code><a href="reference/checkglobals.html">checkglobals()</a></code> scans all files in the <code>/R</code> folder of the package and contrasts the detected (unrecognized) globals and imports against the imports listed in the NAMESPACE file of the package. R-scripts present elsewhere in the package (e.g. in the <code>/inst</code> folder) are <strong>not</strong> analyzed, as these are not coupled to the package NAMESPACE file. To illustrate, we can run <code><a href="reference/checkglobals.html">checkglobals()</a></code> on its own package folder:</p>
<p><img src="reference/figures/README/screen06.svg" width="85%" style="display: block; margin: auto;"></p>
<div class="section level4">
<h4 id="bundled-r-packages">Bundled R-packages<a class="anchor" aria-label="anchor" href="#bundled-r-packages"></a>
</h4>
<p>Instead of local R-package folders, the <code>pkg</code> argument also accepts file paths to bundled source R-packages (tar.gz). This can either be a tar.gz package on the local filesystem, or a remote file location, such as the web (similar to the <code>file</code> argument).</p>
<div class="section level5">
<h5 id="local-filesystem">Local filesystem:<a class="anchor" aria-label="anchor" href="#local-filesystem"></a>
</h5>
<p><img src="reference/figures/README/screen07.svg" width="85%" style="display: block; margin: auto;"></p>
</div>
<div class="section level5">
<h5 id="remote-file-location">Remote file location:<a class="anchor" aria-label="anchor" href="#remote-file-location"></a>
</h5>
<p><img src="reference/figures/README/screen08a.svg" width="85%" style="margin-left:70px"><img src="reference/figures/README/screen08b.svg" width="85%" style="margin-top:-20px;margin-left:70px"></p>
<p><br></p>
<p><strong>Remark</strong>: if <code><a href="reference/checkglobals.html">checkglobals()</a></code> is called without a <code>file</code>, <code>dir</code>, <code>text</code> or <code>pkg</code> argument, the function is run in the current working directory. If the current working directory is an R-package folder, this is identical to <code>checkglobals(pkg = ".")</code>, otherwise the behavior is the same as <code>checkglobals(dir = ".")</code>.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="programmatic-use">Programmatic use<a class="anchor" aria-label="anchor" href="#programmatic-use"></a>
</h3>
<p>Several methods (e.g. <code>as.data.frame</code>, <code>as.matrix</code> or <code>as.character</code>) are available to cast the S3-objects returned by <code><a href="reference/checkglobals.html">checkglobals()</a></code> to common R-objects. This can be useful for further programmatic use of the returned output:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chk</span> <span class="op">&lt;-</span> <span class="fu">checkglobals</span><span class="fu">::</span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>pkg <span class="op">=</span> <span class="st">"../checkglobals"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## data.frame with globals/imports </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">chk</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  name  package   type</span></span>
<span><span class="co">#&gt; 1          ansi_align      cli import</span></span>
<span><span class="co">#&gt; 2          ansi_nchar      cli import</span></span>
<span><span class="co">#&gt; 3        ansi_strtrim      cli import</span></span>
<span><span class="co">#&gt; 4         ansi_trimws      cli import</span></span>
<span><span class="co">#&gt; 5   cli_alert_success      cli import</span></span>
<span><span class="co">#&gt; 6   cli_alert_warning      cli import</span></span>
<span><span class="co">#&gt; 7              cli_h1      cli import</span></span>
<span><span class="co">#&gt; 8      code_highlight      cli import</span></span>
<span><span class="co">#&gt; 9            col_blue      cli import</span></span>
<span><span class="co">#&gt; 10          col_green      cli import</span></span>
<span><span class="co">#&gt; 11           col_grey      cli import</span></span>
<span><span class="co">#&gt; 12            col_red      cli import</span></span>
<span><span class="co">#&gt; 13          col_white      cli import</span></span>
<span><span class="co">#&gt; 14         col_yellow      cli import</span></span>
<span><span class="co">#&gt; 15      console_width      cli import</span></span>
<span><span class="co">#&gt; 16         style_bold      cli import</span></span>
<span><span class="co">#&gt; 17    style_hyperlink      cli import</span></span>
<span><span class="co">#&gt; 18       style_italic      cli import</span></span>
<span><span class="co">#&gt; 19             symbol      cli import</span></span>
<span><span class="co">#&gt; 20               tree      cli import</span></span>
<span><span class="co">#&gt; 21          read_json jsonlite import</span></span>
<span><span class="co">#&gt; 22             toJSON jsonlite import</span></span>
<span><span class="co">#&gt; 23         write_json jsonlite import</span></span>
<span><span class="co">#&gt; 24               purl    knitr import</span></span>
<span><span class="co">#&gt; 25      download.file    utils import</span></span>
<span><span class="co">#&gt; 26 installed.packages    utils import</span></span>
<span><span class="co">#&gt; 27             relist    utils import</span></span>
<span><span class="co">#&gt; 28              untar    utils import</span></span>
<span></span>
<span><span class="co">## vector of package dependencies</span></span>
<span><span class="fu">checkglobals</span><span class="fu">::</span><span class="fu"><a href="reference/as_vector.html">as_vector</a></span><span class="op">(</span><span class="va">chk</span><span class="op">)</span><span class="op">[[</span><span class="st">"package"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "cli"      "jsonlite" "knitr"    "utils"</span></span></code></pre></div>
<p>The <code>as_sarif_json</code> method generates a <a href="https://docs.oasis-open.org/sarif/sarif/v2.1.0/sarif-v2.1.0.html" class="external-link">SARIF</a> (Static Analysis Results Interchange Format) JSON from a <code>checkglobals</code> S3-object for upload to external CI servers, (e.g. <a href="https://docs.github.com/en/code-security/code-scanning/integrating-with-code-scanning/sarif-support-for-code-scanning" class="external-link">GitHub Code Scanning</a>, Jenkins <a href="https://plugins.jenkins.io/warnings-ng/" class="external-link">warnings-ng</a> plugin, or <a href="https://learn.microsoft.com/en-us/azure/devops/pipelines/tasks/reference/advanced-security-publish-v1?view=azure-pipelines" class="external-link">Azure DevOps/Pipelines</a>).</p>
<div class="section level4">
<h4 id="github-code-scanning">GitHub Code Scanning<a class="anchor" aria-label="anchor" href="#github-code-scanning"></a>
</h4>
<p>The <code>yaml</code> chunk below is an extract from a GitHub Actions workflow file (source: <a href="https://github.com/JorisChau/checkglobals/blob/main/.github/workflows/detect-globals.yaml" class="external-link uri">https://github.com/JorisChau/checkglobals/blob/main/.github/workflows/detect-globals.yaml</a>) that runs <code><a href="reference/checkglobals.html">checkglobals()</a></code> on the root directory (<code>"."</code>) of an R-package repository and uploads the <code>checkglobals</code> SARIF JSON using the <a href="https://github.com/github/codeql-action/tree/v3/upload-sarif" class="external-link"><code>upload-sarif</code></a> action. <strong>Note</strong>: <code>checkglobals</code> needs to be installed as a dependency in a previous workflow step.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Generate SARIF </span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">  run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    checkglobals::checkglobals(pkg = ".") |&gt;</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    checkglobals::as_sarif_json(</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>              path = file.path(Sys.getenv("GITHUB_WORKSPACE"), "checkglobals.json"),</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>              root_dir = Sys.getenv("GITHUB_WORKSPACE")</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    )</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="at">  </span><span class="fu">shell</span><span class="kw">:</span><span class="at"> Rscript {0}</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Upload SARIF</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="at">  </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> github/codeql-action/upload-sarif@v3</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="at">  </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="at">    </span><span class="fu">sarif_file</span><span class="kw">:</span><span class="at"> ${{ github.workspace }}/checkglobals.json</span></span></code></pre></div>
<p>After successful parsing of the SARIF JSON content, the SARIF result entries are displayed as alerts under <code>Security &gt; Code scanning</code>:</p>
<p><img src="reference/figures/README/screen09.png" width="75%" style="margin-left:70px"></p>
</div>
<div class="section level4">
<h4 id="jenkins-warnings-ng">Jenkins warnings-ng<a class="anchor" aria-label="anchor" href="#jenkins-warnings-ng"></a>
</h4>
<p>In a Jenkins pipeline, if the <a href="https://plugins.jenkins.io/warnings-ng/" class="external-link">warnings-ng</a> plugin is available, the example <code>yaml</code> chunk below can be included in a Jenkinsfile to ingest the <code>checkglobals</code> SARIF JSON obtained from scanning an R-package with <code>checkglobals(pkg = ".")</code>. <strong>Note</strong>: it is again assumed that <code>checkglobals</code> is installed as a dependency in a previous stage.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="at">stage('checkglobals') {</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="at">    steps {</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="at">        sh '''R -q -e \'{</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="at">          checkglobals::checkglobals(pkg = ".") |&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="at">          checkglobals::as_sarif_json(</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="at">                  path = "checkglobals.sarif.json",</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="at">                  root_dir = ".",</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="at">                  markdown = TRUE</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="at">          )</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="at">        }\''''</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="at">    }</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="at">  post {</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="at">      always {</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="at">          </span><span class="fu">recordIssues enabledForFailure</span><span class="kw">:</span><span class="at"> true, tool: sarif(pattern: "*.sarif.json", name: "checkglobals")</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="at">      }</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="at">  }</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="at">}</span></span></code></pre></div>
<p>The <a href="https://plugins.jenkins.io/warnings-ng/" class="external-link">warnings-ng</a> plugin reports the SARIF result entries as individual issues in addition to various summary charts and statistics.</p>
<p><img src="reference/figures/README/screen10.png" width="75%" style="margin-left:70px"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="known-limitations">Known limitations<a class="anchor" aria-label="anchor" href="#known-limitations"></a>
</h2>
<p>Below is a non-exhaustive list of known limitations of the static code analysis performed by <code><a href="reference/checkglobals.html">checkglobals()</a></code> to keep in mind for practical use. These are cases that are either too ambiguous or complex to be analyzed without evaluation of the code itself, where <code><a href="reference/checkglobals.html">checkglobals()</a></code> fails to recognize a variable name (false negative) or falsely detects a global variable when it should not (false positive).</p>
<div class="section level4">
<h4 id="character-variablefunction-names">Character variable/function names<a class="anchor" aria-label="anchor" href="#character-variablefunction-names"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## this works (character arguments are recognized as functions)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'do.call(args = list(1), what = "median")'</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'Map("g", 1, n = 1)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'stats::aggregate(x ~ ., data = y, FUN = "g")'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## this doesn't work (evaluation is required)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'g &lt;- "f"; Map(g, 1, n = 1)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"eval(substitute(g))"</span><span class="op">)</span> <span class="co">## same for ~, expression, quote, bquote, Quote, etc.</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## this works (calling a function in an exotic way)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'"head"(1:10)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'`::`("utils", "head")(1:10)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'list("function" = utils::head)$`function`(1:10)'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## this doesn't work (evaluation is required)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'get("head")(1:10)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'methods::getMethod("f", signature = "ANY")'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="package-loading">Package loading<a class="anchor" aria-label="anchor" href="#package-loading"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## this works (simple evaluation of package names)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'attachNamespace("utils"); head(1:10)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'pkg &lt;- "utils"; library(pkg, character.only = TRUE); head(1:10)'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## this doesn't work (more complex evaluation is required)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'pkg &lt;- function() "utils"; library(pkg(), character.only = TRUE); head(1:10)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'loadPkg &lt;- library; loadPkg(utils)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'box::use(utils[...])'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="unknown-symbols">Unknown symbols<a class="anchor" aria-label="anchor" href="#unknown-symbols"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## this works (special functions self, private, super are recognized)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'R6::R6Class("cl",</span></span>
<span><span class="st">                   public = list(</span></span>
<span><span class="st">                     initialize = function(...) self$f(...),</span></span>
<span><span class="st">                     f = function(...) private$p</span></span>
<span><span class="st">                   ),</span></span>
<span><span class="st">                   private = list(</span></span>
<span><span class="st">                     p = list()</span></span>
<span><span class="st">                   ))'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## this doesn't work (data masking)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'transform(mtcars, mpg2 = mpg^2)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'attach(iris); print(Sepal.Width)'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="lazy-evaluation">Lazy evaluation<a class="anchor" aria-label="anchor" href="#lazy-evaluation"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## this works (basic lazy evaluation)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'{</span></span>
<span><span class="st">    addy &lt;- function(y) x + y </span></span>
<span><span class="st">    x &lt;- 0</span></span>
<span><span class="st">    addy(1)</span></span>
<span><span class="st">}'</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span></span>
<span>  text <span class="op">=</span> <span class="st">'function() { </span></span>
<span><span class="st">    on.exit(rm(x))</span></span>
<span><span class="st">    x &lt;- 0 </span></span>
<span><span class="st">}'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## this doesn't work (lazy evaluation in external functions)</span></span>
<span><span class="fu"><a href="reference/checkglobals.html">checkglobals</a></span><span class="op">(</span></span>
<span>  text <span class="op">=</span> <span class="st">'server &lt;- function(input, output) {</span></span>
<span><span class="st">    add1x &lt;- shiny::reactive({</span></span>
<span><span class="st">      add1(input$x)</span></span>
<span><span class="st">    })</span></span>
<span><span class="st">    add1 &lt;- function(x) x + 1  </span></span>
<span><span class="st">  }'</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="useful-references">Useful references<a class="anchor" aria-label="anchor" href="#useful-references"></a>
</h2>
<p>Other useful functions and R-packages with design goals and/or functionality related to {checkglobals} include:</p>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/codetools/man/findGlobals.html" class="external-link">codetools::findGlobals()</a></code>, detects global variables from R-scripts via static code analysis. This and other <em>codetools</em> functions underlie the source code checks run by <code>R CMD check</code>.</li>
<li>
<a href="https://CRAN.R-project.org/package=globals" class="external-link">globals</a>, R-package by H. Bengtsson providing a re-implementation of the functions in <em>codetools</em> to identify global variables using various strategies for export in parallel computations.</li>
<li>
<code><a href="https://rstudio.github.io/renv/reference/dependencies.html" class="external-link">renv::dependencies()</a></code>, detects R-package dependencies by scanning all R-files in a project for imported functions or packages via static code analysis.</li>
<li>
<a href="https://CRAN.R-project.org/package=lintr" class="external-link">lintr</a>, R-package by J. Hester and others to perform general static code analysis in R projects. <code><a href="https://lintr.r-lib.org/reference/object_usage_linter.html" class="external-link">lintr::object_usage_linter()</a></code> provides a wrapper of <code><a href="https://rdrr.io/pkg/codetools/man/checkUsage.html" class="external-link">codetools::checkUsage()</a></code> to detect global variables similar to <code>R CMD check</code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>MIT</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=checkglobals" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/JorisChau/checkglobals/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/JorisChau/checkglobals/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing checkglobals</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Joris Chau <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=checkglobals" class="external-link"><img src="https://www.r-pkg.org/badges/version/checkglobals" alt="CRAN version"></a></li>
<li><a href="https://github.com/JorisChau/checkglobals/actions" class="external-link"><img src="https://github.com/JorisChau/checkglobals/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/JorisChau/checkglobals" class="external-link"><img src="https://codecov.io/gh/JorisChau/checkglobals/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://CRAN.R-project.org/package=checkglobals" class="external-link"><img src="https://tinyverse.netlify.app/badge/checkglobals" alt="status"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joris Chau.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
